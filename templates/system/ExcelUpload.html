{% extends "base-left.html" %}
{% load staticfiles %}
{% block css %}
    <link rel="stylesheet" href="{% static 'layui/css/layui.css' %}">
    <style>
        .layui-card-header {
        {#float: left;#} font-size: large;
        {#    border: solid 1px #eee;#}
        }
    </style>
{% endblock %}

{% block content %}

    {#    <div style="padding: 20px; margin-top: 2%">#}
    {#        <div class="layui-row layui-col-space15" style="height: 850px">#}
    {##}
    {#            <div class="layui-col-md8 ">#}
    {#                <div class="layui-row layui-col-space10 ">#}
    {#            <div class="layui-col-md12">#}
    {#                <div class="layui-card">#}
    {#                    <div class="layui-card-header"><span> <i class="fa fa-twitch"></i> 首页上传</span></div>#}
    {#                    <div class="layui-card-body" style=" height:450px; overflow:auto;">#}
    {#                        <form class="form-horizontal" method="post" action="{% url 'system:daily-excel' %}"#}
    {#                              enctype="multipart/form-data">#}
    {#                            <table class="layui-table" lay-skin="line">#}
    {#                                <thead>#}
    {#                                <tr>#}
    {#                                    <th>标题</th>#}
    {#                                    <th>操作</th>#}
    {#                                </tr>#}
    {#                                </thead>#}
    {#                                <tbody>#}
    {#                                <tr>#}
    {#                                    <td style="color:#040202; width: 12%">版本概览</td>#}
    {#                                    <td><input type="file" id="ver_id" value="上传"></td>#}
    {#                                </tr>#}
    {#                                <tr>#}
    {#                                    <td style="color:#040202; width: 12%">值日</td>#}
    {#                                    <td><input type="file" id="duty_id" value="上传"></td>#}
    {#                                </tr>#}
    {#                                <tr>#}
    {#                                    <td style="color:#040202; width: 12%">工程师排名</td>#}
    {#                                    <td><input type="file" id="pro_id" value="上传"></td>#}
    {#                                </tr>#}
    {##}
    {#                                </tbody>#}
    {#                            </table>#}
    {#                            <input type="submit" value="确认">#}
    {#                        </form>#}
    {#                    </div>#}
    {#                </div>#}
    {#                    </div>#}
    {##}
    {#                </div>#}
    {#            </div>#}
    {#        </div>#}
    {#    </div>#}
    <form class="form-horizontal" method="post" id="addForm" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="form-group">
            <label for="firstname" class="col-sm-2 control-label">版本概览：</label>
            <div class="col-sm-8">
                <input type="file" class="form-control" name="excel1" id="input-1" placeholder="请输入名字">
            </div>
        </div>

        <div class="form-group">
            <label for="firstname" class="col-sm-2 control-label">值日概览：</label>
            <div class="col-sm-8">
                <input type="file" class="form-control" name="excel2" id="input-2" placeholder="请输入名字">
            </div>
        </div>

        <div class="form-group">
            <label for="firstname" class="col-sm-2 control-label">工程师排名：</label>
            <div class="col-sm-8">
                <input type="file" class="form-control" name="excel3" id="input-3" placeholder="请输入名字">
            </div>
        </div>


        <input type="button" value="确认" id="btnSave" style="margin-left: 40%;width: 10%;height: 25%">
    </form>
{% endblock %}


{% block javascripts %}
    <script src="{% static 'layui/layui.js' %}"></script>
    <script src="{% static 'js/plugins/layer/layer.js' %}"></script>
    <script type="text/javascript">
        $(function () {
            $('#SYSTEM-DAILY').addClass('active');
            $('#SYSTEM-DAILY-VER').addClass('active');

        });


        // on操作的追加后的元素， click无法选中，用on追踪
        $("#btnSave").click(function () {
            var form_data = new FormData();
            var f1 = $('#input-1')[0].files[0];
            var f2 = $('#input-2')[0].files[0];
            var f3 = $('#input-3')[0].files[0];
            form_data.append('f1', f1);
            form_data.append('f2', f2);
            form_data.append('f3', f3);
            $.ajax({
                type: "POST",
                url: "{% url 'system:daily-excel' %}",
                data: form_data,
                cache: false,
                processData: false,
                contentType: false,
                success: function (msg) {
                    if (msg.result) {
                        layer.alert(msg.msg, {icon: 1}, function (index) {
                            parent.layer.closeAll(); //关闭所有弹窗
                            window.location.reload();
                        });

                    } else {
                        layer.alert(msg.msg, {icon: 2});
                    }
                    return;
                }
            });
        });


    </script>

{% endblock %}
