{#{% extends "base-left.html" %}#}
{#{% load staticfiles %}#}
{##}
{#{% block css %}#}
{#    <link rel="stylesheet" href="{% static 'plugins/datatables/jquery.dataTables.min.css' %}">#}
{#    <link rel="stylesheet" href="{% static 'js/plugins/layer/skin/layer.css' %}">#}
{#    <link rel="stylesheet" href="{% static 'plugins/select2/select2.min.css' %}">#}
{#    <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap-datetimepicker.min.css' %}">#}
{##}
{#    <!--导出excel-->#}
{#    <!--<link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">-->#}
{#    <!--<link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.5.2/css/buttons.dataTables.min.css">-->#}
{##}
{##}
{#    <!-- iCheck for checkboxes and radio inputs -->#}
{#{% endblock %}#}
{##}
{#{% block content %}#}
{##}
{#    <!-- Main content -->#}
{#    <section class="content">#}
{#        <div id="devlist">#}
{#            <div class="box box-primary" id="liebiao">#}
{##}
{#                <div class="box-header">#}
{#                    <div class="btn-group pull-left">#}
{#                        <button type="button" id="btnRefresh" class="btn btn-default">#}
{#                            <i class="glyphicon glyphicon-repeat"></i>刷新#}
{#                        </button>#}
{#                    </div>#}
{##}
{#                    <div class="btn-group pull-left">&nbsp</div>#}
{#                </div>#}
{##}
{#                <div class="box-header">#}
{#                    <form class="form-inline" id="queryForm">#}
{##}
{#                        <div class="form-group searchArea margin-r-5 margin-top-5">#}
{#                            <label>專案：</label>#}
{#                            <select class="form-control inputText select2" name="fk_project" id="fk_project_id">#}
{#                                <option></option>#}
{#                                {% for project in projects %}#}
{#                                    <option value="{{ project.id }}">{{ project.pname }}</option>#}
{#                                {% endfor %}#}
{#                            </select>#}
{#                        </div>#}
{##}
{#                        <div class="form-group searchArea margin-r-5 margin-top-5">#}
{#                            <label>階段：</label>#}
{#                            <select class="form-control inputText select2" name="fk_stage" id="fk_stage_id">#}
{#                                <option></option>#}
{#                                {% for stage in stages %}#}
{#                                    <option value="{{ stage.id }}">{{ stage.sname }}</option>#}
{#                                {% endfor %}#}
{#                            </select>#}
{#                        </div>#}
{##}
{#                        <div class="form-group searchArea margin-r-5 margin-top-5">#}
{#                            <label>Rel編號:</label>#}
{#                            <input type="text" name="rel" class="form-control inputText" id="relStart">#}
{#                        </div>#}
{#                        <div class="form-group searchArea margin-r-5 margin-top-5">#}
{#                            <label>——</label>#}
{#                            <input type="text" name="rel" class="form-control inputText" id="relEnd">#}
{#                        </div>#}
{##}
{#                        <!--<div class="form-group searchArea margin-r-5 margin-top-5">-->#}
{#                        <!--<label>當前部門:</label>-->#}
{#                        <!--<select class="form-control inputText select2" name="fk_structure" id="fk_structure_id">-->#}
{#                        <!--<option></option>-->#}
{#                        <!--{% for structure in structures %}-->#}
{#                            <!--<option value="{{ structure.id }}">{{ structure.name }}</option>-->#}
{#                            <!--{% endfor %}-->#}
{#                        <!--</select>-->#}
{#                        <!--</div>-->#}
{##}
{#                        <!--<div class="form-group searchArea margin-r-5 margin-top-5 ">-->#}
{#                        <!--<label>入庫日期:</label>-->#}
{#                        <!--<input type="text" name="indate" class="form-control form_datetime" id="indate">-->#}
{#                        <!--</div>-->#}
{#                        <div class="form-group searchArea margin-r-5 margin-top-5">#}
{#                            <label>SN:</label>#}
{#                            <input type="text" name="rel" class="form-control inputText" id="sn">#}
{#                        </div>#}
{##}
{##}
{#                        <div class="form-group searchArea margin-r-5 margin-top-5">#}
{#                            <label>產品類別:</label>#}
{#                            <select class="form-control inputText select2" name="fk_pt" id="fk_pt_id">#}
{#                                <option></option>#}
{#                                {% for prodtype in prodtypes %}#}
{#                                    <option value="{{ prodtype.id }}">{{ prodtype.ptname }}</option>#}
{#                                {% endfor %}#}
{#                            </select>#}
{#                        </div>#}
{#                        <button type="button" id="btnSearch" class="btn btn-default">#}
{#                            <i class="glyphicon glyphicon-search"></i>查询#}
{#                        </button>#}
{#                    </form>#}
{#                </div>#}
{##}
{#                <div class="box-body">#}
{#                    <table id="dtbList" class="display nowrap" cellspacing="0" width="100%">#}
{#                        <thead>#}
{#                        <tr valign="middle">#}
{#                            <th><input type="checkbox" id="checkAll"></th>#}
{#                            <th>ID</th>#}
{#                            <th>專案</th>#}
{#                            <th>測試階段</th>#}
{#                            <th>Rel編號</th>#}
{#                            <th>SN</th>#}
{#                            <th>產品類型</th>#}
{#                            <th>FA使用時長</th>#}
{#                            <th>Miniline使用時長</th>#}
{#                            <th>EQU使用時長</th>#}
{#                            <th>PM使用時長</th>#}
{#                            <!--<th>操作</th>-->#}
{#                        </tr>#}
{#                        </thead>#}
{#                        <tbody>#}
{#                        </tbody>#}
{#                    </table>#}
{#                    <br> <br>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#    </section>#}
{##}
{#{% endblock %}#}
{##}
{#{% block javascripts %}#}
{#    <script src="{% static 'plugins/datatables/jquery.dataTables.min.js' %}"></script>#}
{#    <script src="{% static 'plugins/datatables/dataTables.const.js' %}"></script>#}
{#    <script src="{% static 'plugins/datatables/moment.min.js' %}"></script>#}
{#    <script src="{% static 'js/plugins/layer/layer.js' %}"></script>#}
{#    <script src="{% static 'plugins/select2/select2.full.min.js' %}"></script>#}
{#    <script src="{% static 'bootstrap/js/bootstrap-datetimepicker.js' %}"></script>#}
{##}
{#    <!--导出excel-->#}
{#    <script src="{% static 'export/js/jquery.dataTables.min.js' %}"></script>#}
{#    <script src="{% static 'export/js/dataTables.buttons.min.js' %}"></script>#}
{#    <script src="{% static 'export/js/buttons.flash.min.js' %}"></script>#}
{#    <script src="{% static 'export/js/jszip.min.js' %}"></script>#}
{#    <script src="{% static 'export/js/pdfmake.min.js' %}"></script>#}
{#    <script src="{% static 'export/js/vfs_fonts.js' %}"></script>#}
{#    <script src="{% static 'export/js/buttons.html5.min.js' %}"></script>#}
{#    <script src="{% static 'export/js/buttons.print.min.js' %}"></script>#}
{#    <script>#}
{#        // $(document).ready(function () {#}
{#        //     $('#dtbList').DataTable({#}
{#        //         dom: 'Bfrtip',#}
{#        //         buttons: [#}
{#        //             'copy', 'csv', 'excel', 'pdf', 'print'#}
{#        //         ]#}
{#        //     });#}
{#        // });#}
{#    </script>#}
{##}
{#    <!-- iCheck 1.0.1 -->#}
{#    <script type="text/javascript">#}
{#        $(function () {#}
{#            $('#DQE-IS').addClass('active');#}
{#            $('#DQE-IS-OUTDATEWARN').addClass('active');#}
{##}
{#        });#}
{#    </script>#}
{##}
{#    <script type="text/javascript">#}
{##}
{##}
{#        var oDataTable = null;#}
{#        $(function () {#}
{##}
{#            oDataTable = initTable();#}
{##}
{#            function initTable() {#}
{#                var oTable = $('#dtbList').DataTable($.extend(true, {},#}
{##}
{#                    DATATABLES_CONSTANT.DATA_TABLES.DEFAULT_OPTION,#}
{##}
{#                    {#}
{##}
{#                        ajax: {#}
{#                            "url": "{% url 'dqe:is-outdatedWarning-list' %}",#}
{#                            "data": function (d) {#}
{##}
{#                                d.fk_project_id = $("#fk_project_id").val();#}
{#                                d.fk_stage_id = $("#fk_stage_id").val();#}
{#                                d.relStart = $("#relStart").val();#}
{#                                d.relEnd = $("#relEnd").val();#}
{#                                d.sn = $("#sn").val();#}
{#                                d.fk_pt_id = $("#fk_pt_id").val();#}
{#                                //d.fk_structure_id = $("#fk_structure_id").val();#}
{#                                //d.indate = $("#indate").val();#}
{#                            },#}
{#                        },#}
{##}
{#                        columns: [#}
{#                            DATATABLES_CONSTANT.DATA_TABLES.COLUMN.CHECKBOX,#}
{##}
{#                            {#}
{#                                data: "id",#}
{#                                width: "5%",#}
{#                            },#}
{#                            {#}
{#                                data: "fk_project__pname",#}
{#                            },#}
{#                            {#}
{#                                data: "fk_stage__sname",#}
{#                            },#}
{#                            {#}
{#                                data: "rel",#}
{#                            },#}
{#                            {#}
{#                                data: "sn",#}
{#                            },#}
{#                            {#}
{#                                data: "fk_pt__ptname",#}
{#                            },#}
{#                            {#}
{#                                data: "FA",#}
{#                                render: function (data, type, full, meta) {#}
{#                                    if (data == ' ') {#}
{#                                        return "--";#}
{#                                    } else {#}
{#                                        return data#}
{#                                    }#}
{#                                }#}
{#                            },#}
{#                            {#}
{#                                data: "MiniLine",#}
{#                                render: function (data, type, full, meta) {#}
{#                                    if (data == ' ') {#}
{#                                        return "--";#}
{#                                    } else {#}
{#                                        return data#}
{#                                    }#}
{#                                }#}
{#                            },#}
{#                            {#}
{#                                data: "EQU",#}
{#                                render: function (data, type, full, meta) {#}
{#                                    if (data == ' ') {#}
{#                                        return "--";#}
{#                                    } else {#}
{#                                        return data#}
{#                                    }#}
{#                                }#}
{#                            },#}
{#                            {#}
{#                                data: "PM",#}
{#                                render: function (data, type, full, meta) {#}
{#                                    if (data == ' ') {#}
{#                                        return "--";#}
{#                                    } else {#}
{#                                        return data#}
{#                                    }#}
{#                                }#}
{#                            },#}
{#                            // {#}
{#                            //     data: "indate",#}
{#                            //     render: function (data, type, full, meta) {#}
{#                            //         return moment(data).format("YYYY-MM-DD HH:mm");#}
{#                            //     }#}
{#                            //#}
{#                            // },#}
{#                            // {#}
{#                            //     data: "recuser",#}
{#                            // },#}
{#                            // {#}
{#                            //     data: "state",#}
{#                            //     render: function (data, type, row, meta) {#}
{#                            //         //console.log(">0>", data, ">1>", type, ">2>", row, ">3>", meta);#}
{#                            //         if (data == 1) {#}
{#                            //             return "入庫"#}
{#                            //         } else if (data == 2) {#}
{#                            //             return "可申請"#}
{#                            //         } else if (data == 3) {#}
{#                            //             return "被申請"#}
{#                            //         } else {#}
{#                            //             return "出庫"#}
{#                            //         }#}
{#                            //     }#}
{#                            // },#}
{#                            // {#}
{#                            //     data: "fk_structure__name",#}
{#                            // },#}
{#                            // {#}
{#                            //     data: "remark",#}
{#                            // },#}
{#                            // {#}
{#                            //#}
{#                            //     render: function (data, type, full, meta) {#}
{#                            //         //var indate = new Date(full.indate);  不是入库时间 、改为当前接收时间#}
{#                            //         //console.log(full);#}
{#                            //         var indate = new Date(full.currRecDate.replace(/-/g, "/").replace(/(\.\d+)?/g, ""));#}
{#                            //         //alert(indate);#}
{#                            //#}
{#                            //         var mytime = new Date();     //获取当前时间#}
{#                            //#}
{#                            //         var s1 = indate.getTime(), s2 = mytime.getTime();#}
{#                            //#}
{#                            //         var total = (s2 - s1) / 1000;#}
{#                            //#}
{#                            //         var day = parseInt(total / (24 * 60 * 60));//计算整数天数#}
{#                            //#}
{#                            //         var afterDay = total - day * 24 * 60 * 60;//取得算出天数后剩余的秒数#}
{#                            //#}
{#                            //         var hour = parseInt(afterDay / (60 * 60));//计算整数小时数#}
{#                            //#}
{#                            //         var afterHour = total - day * 24 * 60 * 60 - hour * 60 * 60;//取得算出小时数后剩余的秒数#}
{#                            //#}
{#                            //         var min = parseInt(afterHour / 60);//计算整数分#}
{#                            //#}
{#                            //         var afterMin = total - day * 24 * 60 * 60 - hour * 60 * 60 - min * 60;//取得算出分后剩余的秒数#}
{#                            //#}
{#                            //         return day + "D" + " " + hour + "H";#}
{#                            //#}
{#                            //     }#}
{#                            // },#}
{#                            // {#}
{#                            //     data: "id",#}
{#                            //     width: "12%",#}
{#                            //     bSortable: "false",#}
{#                            //     render: function (data, type, row, meta) {#}
{#                            //#}
{#                            //         var ret = "<button title='详情' onclick='doDetail("#}
{#                            //             + data + ")'><i class='glyphicon glyphicon-list-alt'></i></button>";#}
{#                            //#}
{#                            //         return ret;#}
{#                            //     }#}
{#                            // }#}
{#                        ],#}
{#                        "order": [[1, 'id']],#}
{##}
{#                    }#}
{#                    // {#}
{#                    //     dom: 'Bfrtip',#}
{#                    //     buttons:#}
{#                    //         [#}
{#                    //             'copy', 'csv', 'excel', 'pdf', 'print',#}
{#                    //         ]#}
{#                    // }#}
{#                ));#}
{##}
{#                return oTable;#}
{#            };#}
{##}
{##}
{#        });#}
{##}
{#        //查询#}
{#        $("#btnSearch").click(function () {#}
{#            oDataTable.ajax.reload();#}
{#        });#}
{##}
{#        //checkbox全选#}
{#        $("#checkAll").on("click", function () {#}
{#            if ($(this).prop("checked") === true) {#}
{#                $("input[name='checkList']").prop("checked", $(this).prop("checked"));#}
{#                $('#example tbody tr').addClass('selected');#}
{#            } else {#}
{#                $("input[name='checkList']").prop("checked", false);#}
{#                $('#example tbody tr').removeClass('selected');#}
{#            }#}
{#        });#}
{##}
{#        //刷新#}
{#        $("#btnRefresh").click(function () {#}
{#            oDataTable.ajax.reload();#}
{#        });#}
{##}
{##}
{#        /*input 时间输入选择*/#}
{#        $(".form_datetime").datetimepicker({#}
{#            language: 'zh',#}
{#            minView: 'month', //选择范围知道日期，不选择时分#}
{#            //weekStart: 1,#}
{#            //todayBtn:  1,#}
{#            autoclose: 1,#}
{#            todayHighlight: 1,#}
{#            //startView: 2,#}
{#            forceParse: 0,#}
{#            showMeridian: 1,#}
{#            format: 'yyyy-mm-dd'#}
{#        }).on('changeDate', function (ev) {#}
{#            $(this).datetimepicker('hide');#}
{#        });#}
{##}
{#        $(function () {#}
{#            //Initialize Select2 Elements#}
{#            $(".select2").select2();#}
{#        });#}
{#/*专案阶段二级联动*/#}
{##}
{#    $("select[name='fk_project']").change(function(){#}
{##}
{#		var fk_project_id = $("select[name='fk_project']").val();#}
{##}
{#		//alert(fk_project_id);#}
{##}
{#		$.ajax({#}
{#			type: "POST",#}
{##}
{#			url : "{% url 'system:basic-project-stage' %}",#}
{##}
{#			data : {"fk_project_id":fk_project_id, csrfmiddlewaretoken: '{{ csrf_token }}'},#}
{##}
{#			success : function(data) {#}
{#			    //console.log(data);#}
{#			    //console.log(data.stages);#}
{#			    //console.log(data.stages.length);#}
{##}
{#                var fk_st = $("select[name='fk_stage']").empty();  //.append('<option value>'+'--请选择--'+'</option>');#}
{#                fk_st.append('<option></option>')#}
{#                $.each(data.stages,function(i,val){#}
{#                        //console.log(i + "===" + val.id)  // #表示浏览器控制台下打印消息#}
{#                        fk_st.append('<option value="'+val.id+'">'+val.sname+'</option>')                   #}
{#                })#}
{##}
{#			}#}
{#		});#}
{##}
{#	});#}
{#    </script>#}
{##}
{#{% endblock %}#}